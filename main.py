from flask import Flask, render_template, request, send_file
from reportlab.pdfgen import canvas
from reportlab.pdfbase.ttfonts import TTFont
from reportlab.pdfbase import pdfmetrics
from reportlab.platypus import Table, TableStyle
from reportlab.lib import colors
from reportlab.lib.pagesizes import A4
from reportlab.lib.units import cm
import arabic_reshaper
from bidi.algorithm import get_display
import requests
import os

app = Flask(__name__)

# Ù…Ø­ØµÙˆÙ„Ø§Øª Ù†Ù…ÙˆÙ†Ù‡
products = {
       "3390": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 697000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1107": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø³ÙÛŒØ¯ Ùˆ Ù…Ø´Ú©ÛŒ", "price": 547000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1303": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 4 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ± Ø¨Ù‡ Ø¬Ø² Ø³Ø¨Ø²", "price": 747000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3389": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 4 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ± (Ù…Ø§Ù†ØªÙˆ Ú©ØªÛŒ)", "price": 797000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1106": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ø¯Ùˆ Ø·Ø±Ø­ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 397000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1203": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø³ÙÛŒØ¯", "price": 547000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1213": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 497000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3392": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ± (Ú©Ø±Ù… Ùˆ Ù…Ø´Ú©ÛŒ)", "price": 597000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3357": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 5 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 427000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1108": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 647000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3346": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 597000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1204": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 5 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 597000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3340": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 567000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1114": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 7 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ± (PERRY ØªØ±Ú©)", "price": 637000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1102": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 5 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 397000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1301": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 4 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 597000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3377": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 597000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3759": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 347000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1117": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 697000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3395": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 757000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3364": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 457000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1201": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 4 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ú©Ø±Ù…", "price": 797000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3383": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 657000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1202": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 737000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1211": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 567000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3345": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 597000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3752": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 347000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3356": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 697000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1209": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 497000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1208": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 7 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 397000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1305": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 4 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: ÙÙ‚Ø· Ú¯Ù„ Ù‚Ø±Ù…Ø²", "price": 517000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3353": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 417000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1210": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 657000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3370": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 697000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1302": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ± Ø¨Ø§ Ø³ÙÛŒØ¯ Ùˆ Ù…Ø´Ú©ÛŒ Ø¯ÙˆØ¨Ù„", "price": 497000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3325": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 4 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 497000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3781": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 4 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ù…Ø´Ú©ÛŒ", "price": 397000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3341": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ù…Ø´Ú©ÛŒ", "price": 637000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3379": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 4 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 697000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1105": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 737000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3381": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 4 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ± (Ù‚Ù„Ø§Ø¨ Ø¨Ø§ÙÛŒ Ø³Ø¨Ú©)", "price": 597000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3762": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ± (Ø¬Ù†Ø³ Ù¾Ø§Ø±Ú†Ù‡ Ø¯Ø± ØªØµÙˆÛŒØ± Ø±Ù†Ú¯Ø¨Ù†Ø¯ÛŒ)", "price": 697000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3384": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ù…Ø´Ú©ÛŒ Ø³Ø¨Ø² Ø·ÙˆØ³ÛŒ", "price": 647000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1111": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 5 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 797000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1306": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 5 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 597000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3329": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 5 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø³Ù‡ Ø±Ù†Ú¯ Ø¨Ø§ Ø³ÙÛŒØ¯ Ù…Ø´Ú©ÛŒ Ø¯ÙˆØ¨Ù„", "price": 557000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3791": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 597000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3348": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 8 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 297000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3494": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 497000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3394": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 957000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1116": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 4 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 647000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1112": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 4 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 597000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "3393": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 597000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1115": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 6 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 547000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
    "1118": {"name": "ÙØ±ÛŒ Ø³Ø§ÛŒØ² - Ù¾Ú© 4 Ø¹Ø¯Ø¯ÛŒ Ø±Ù†Ú¯: Ø¯Ø± ØªØµÙˆÛŒØ±", "price": 697000, "unit": "Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†"},
}
}

# Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø¯ÛŒØ± Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ PDF
ADMIN_CHAT_ID = 6933858510
TELEGRAM_TOKEN = "7739258515:AAEUXIZ3ySZ9xp9W31l7qr__sZkbf6qcKnE"

# Ø«Ø¨Øª ÙÙˆÙ†Øª ÙØ§Ø±Ø³ÛŒ
FONT_PATH = "Vazirmatn-Regular.ttf"
if not os.path.exists(FONT_PATH):
    raise Exception("ÙÙˆÙ†Øª ÙØ§Ø±Ø³ÛŒ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯! Ù„Ø·ÙØ§ Vazirmatn-Regular.ttf Ø±Ø§ Ú©Ù†Ø§Ø± ÙØ§ÛŒÙ„ Ù‚Ø±Ø§Ø± Ø¨Ø¯Ù‡.")
pdfmetrics.registerFont(TTFont('Vazir', FONT_PATH))

def reshape_text(text):
    return get_display(arabic_reshaper.reshape(text))

@app.route('/')
def index():
    return render_template("index.html", products=products)

@app.route('/order', methods=['POST'])
def order():
    name = request.form.get("name")
    phone = request.form.get("phone")
    address = request.form.get("address")
    order_codes = request.form.getlist("order_code")
    order_counts = request.form.getlist("order_count")

    # ÙØ§ÛŒÙ„ PDF
    filename = f"invoice_{phone}.pdf"
    c = canvas.Canvas(filename, pagesize=A4)
    width, height = A4
    y_start = height - 2*cm

    c.setFont("Vazir", 16)
    c.drawCentredString(width/2, y_start, reshape_text("ğŸ§¾ ÙØ§Ú©ØªÙˆØ± Ø³ÙØ§Ø±Ø´"))
    y = y_start - 2*cm

    c.setFont("Vazir", 12)
    c.drawRightString(width - 2*cm, y, reshape_text(f"Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ: {name}"))
    y -= 1*cm
    c.drawRightString(width - 2*cm, y, reshape_text(f"Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³: {phone}"))
    y -= 1*cm
    c.drawRightString(width - 2*cm, y, reshape_text(f"Ø¢Ø¯Ø±Ø³: {address}"))
    y -= 1.5*cm

    # Ø¬Ø¯ÙˆÙ„ Ù…Ø­ØµÙˆÙ„Ø§Øª
    table_data = [
        [reshape_text("Ú©Ø¯ Ù…Ø­ØµÙˆÙ„"), reshape_text("Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„"), reshape_text("ØªØ¹Ø¯Ø§Ø¯"), reshape_text("Ù‚ÛŒÙ…Øª ÙˆØ§Ø­Ø¯"), reshape_text("Ù…Ø¨Ù„Øº Ú©Ù„")]
    ]
    total = 0
    for code, count in zip(order_codes, order_counts):
        count = int(count)
        product = products.get(code)
        if product:
            price = product["price"]
            sum_price = price * count
            total += sum_price
            table_data.append([
                reshape_text(code),
                reshape_text(product["name"]),
                reshape_text(str(count)),
                reshape_text(str(price)),
                reshape_text(str(sum_price))
            ])

    from reportlab.platypus import Table, TableStyle
    table = Table(table_data, colWidths=[3*cm, 7*cm, 2*cm, 3*cm, 3*cm])
    style = TableStyle([
        ('GRID', (0,0), (-1,-1), 1, colors.black),
        ('BACKGROUND', (0,0), (-1,0), colors.lightgrey),
        ('FONTNAME', (0,0), (-1,-1), 'Vazir'),
        ('FONTSIZE', (0,0), (-1,-1), 10),
        ('ALIGN', (0,0), (-1,-1), 'CENTER'),
        ('BOTTOMPADDING', (0,0), (-1,0), 12),
    ])
    table.setStyle(style)

    table.wrapOn(c, width, height)
    table.drawOn(c, 2*cm, y - len(table_data)*1.2*cm)
    y -= (len(table_data)*1.2*cm + 1*cm)

    c.drawRightString(width - 2*cm, y, reshape_text(f"Ø¬Ù…Ø¹ Ú©Ù„: {total} ØªÙˆÙ…Ø§Ù†"))
    c.save()

    # Ø§Ø±Ø³Ø§Ù„ PDF Ø¨Ù‡ Ù…Ø¯ÛŒØ±
    url = f"https://api.telegram.org/bot{TELEGRAM_TOKEN}/sendDocument"
    with open(filename, "rb") as f:
        requests.post(url, data={"chat_id": ADMIN_CHAT_ID}, files={"document": f})

    # Ù†Ù…Ø§ÛŒØ´ PDF Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±
    return send_file(filename, as_attachment=True)

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000, debug=True)
